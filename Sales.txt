import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans
from scipy.cluster.hierarchy import dendrogram,linkage

df=pd.read_csv(r'E:\7thsemcodes\ML\sales_data_sample.csv', encoding='latin1')
df=df.select_dtypes(include=['number']).copy()
df.dropna(inplace=True)

scaled=StandardScaler()
scale_data=scaled.fit_transform(df)

wcss=[]
K=range(1,11)
for k in K:
    km=KMeans(n_clusters=k,random_state=42,n_init=10)
    km.fit(scale_data)
    wcss.append(km.inertia_)

plt.figure(figsize=(7,5))
plt.plot(K,wcss,marker='o')
plt.title("Elbow plot for K clusters")
plt.xlabel("number of clusters")
plt.ylabel("WCSS")
plt.show()

k=3
kmeans=KMeans(n_clusters=k,random_state=42,n_init=10)

clusters=kmeans.fit_predict(scale_data)
df['clusters']=clusters
print(df.head(8))

from sklearn.decomposition import PCA
pca=PCA(n_components=2)
pca_data=pca.fit_transform(scale_data)

plt.figure(figsize=(7,5))
plt.scatter(pca_data[:,0],pca_data[:,1],c=clusters)
plt.title("\n K means clustering")
plt.xlabel("PC1")
plt.ylabel("PC2")
plt.show()

linked=linkage(scale_data,method="ward")


plt.figure(figsize=(10,6))
dendrogram(linked)
plt.axhline(y=75,color="red",linestyle="--",linewidth=2)
plt.title("Hierarchical Clustering Dendrogram")
plt.xlabel("Samples")
plt.ylabel("Distance")
plt.show()





